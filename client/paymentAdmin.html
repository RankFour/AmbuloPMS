<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/paymentAdmin.css">
    <link rel="stylesheet" href="/css/navigationsAdmin.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <title>Manage Payment</title>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    
    <div id="sidebarContainer"></div>
    <div id="navbarContainer"></div>

    <div class="main-content">
        <div class="container">
            <!-- Statistics Grid -->
            <div class="stats-grid fade-in">
                <div class="stat-card charges" onclick="filterByType('charges')">
                    <div class="stat-number" id="total-charges">0</div>
                    <div class="stat-label">Total Charges</div>
                </div>
                <div class="stat-card overdue" onclick="filterByStatus('overdue')">
                    <div class="stat-number" id="overdue-charges">0</div>
                    <div class="stat-label">Overdue Charges</div>
                </div>
                <div class="stat-card paid" onclick="filterByStatus('paid')">
                    <div class="stat-number" id="paid-charges">0</div>
                    <div class="stat-label">Paid Charges</div>
                </div>
                <div class="stat-card total-amount">
                    <div class="stat-number" id="total-amount">₱0</div>
                    <div class="stat-label">Total Amount</div>
                </div>
            </div>

            <div class="header-actions">
                <button class="btn btn-primary" onclick="window.location.href='add-charges.html'">
                    <i class="fas fa-plus"></i> Add Charge
                </button>
            </div>

            <!-- Charges Table Section -->
            <div class="table-section fade-in">
                <div class="section-header charges">
                    <div class="section-title">
                        <i class="fas fa-file-invoice"></i>
                        All Charges
                    </div>
                    <div class="section-stats">
                        <div class="section-stat" id="charges-total-stat">0 Total</div>
                        <div class="section-stat" id="charges-overdue-stat">0 Overdue</div>
                        <div class="section-stat" id="charges-active-stat">0 Active</div>
                    </div>
                </div>

                <!-- Charges Filter Section -->
                <div class="filter-section">
                    <div class="filter-grid">
                        <div class="filter-item">
                            <label>Search Tenant/Unit</label>
                            <input type="text" id="charges-search" placeholder="Search..." oninput="filterCharges()">
                        </div>
                        <div class="filter-item">
                            <label>Charge Type</label>
                            <select id="charges-type" onchange="filterCharges()">
                                <option value="">All Types</option>
                                <option value="rent">Rent</option>
                                <option value="utility">Utility</option>
                                <option value="maintenance">Maintenance</option>
                                <option value="penalty">Penalty</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label>Status</label>
                            <select id="charges-status" onchange="filterCharges()">
                                <option value="">All Statuses</option>
                                <option value="overdue">Overdue</option>
                                <option value="due-soon">Due Soon</option>
                                <option value="pending">Pending</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label>Due Date</label>
                            <input type="month" id="charges-date" onchange="filterCharges()">
                        </div>
                        <div class="filter-item">
                            <button class="btn btn-secondary" onclick="resetChargesFilters()">
                                <i class="fas fa-refresh"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Charges Table Content -->
                <div class="content-area">
                    <!-- Desktop Charges Table -->
                    <div class="table-container">
                        <table class="data-table charges-table">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-user"></i> Tenant</th>
                                    <th><i class="fas fa-building"></i> Unit</th>
                                    <th><i class="fas fa-tag"></i> Type</th>
                                    <th><i class="fas fa-file-alt"></i> Description</th>
                                    <th><i class="fas fa-peso-sign"></i> Amount</th>
                                    <th><i class="fas fa-calendar"></i> Due Date</th>
                                    <th><i class="fas fa-clock"></i> Status</th>
                                    <th><i class="fas fa-cogs"></i> Actions</th>
                                </tr>
                            </thead>
                            <tbody id="charges-tbody">
                                <!-- Content will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Mobile Charges Cards -->
                    <div class="mobile-cards" id="charges-mobile">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Payment History Table Section -->
            <div class="table-section fade-in">
                <div class="section-header payments">
                    <div class="section-title">
                        <i class="fas fa-history"></i>
                        Payment History
                    </div>
                    <div class="section-stats">
                        <div class="section-stat" id="payments-count-stat">0 Payments</div>
                        <div class="section-stat" id="payments-amount-stat">₱0 Collected</div>
                        <div class="section-stat" id="payments-month-stat">This Month: ₱0</div>
                    </div>
                </div>

                <!-- Payment History Filter Section -->
                <div class="filter-section">
                    <div class="filter-grid">
                        <div class="filter-item">
                            <label>Search Tenant/Unit</label>
                            <input type="text" id="payments-search" placeholder="Search..." oninput="filterPayments()">
                        </div>
                        <div class="filter-item">
                            <label>Payment Method</label>
                            <select id="payments-method" onchange="filterPayments()">
                                <option value="">All Methods</option>
                                <option value="cash">Cash</option>
                                <option value="gcash">GCash</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label>Payment Type</label>
                            <select id="payments-type" onchange="filterPayments()">
                                <option value="">All Types</option>
                                <option value="rent">Rent Payment</option>
                                <option value="utility">Utility Payment</option>
                                <option value="maintenance">Maintenance Payment</option>
                                <option value="penalty">Penalty Payment</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label>Payment Date</label>
                            <input type="month" id="payments-date" onchange="filterPayments()">
                        </div>
                        <div class="filter-item">
                            <button class="btn btn-secondary" onclick="resetPaymentsFilters()">
                                <i class="fas fa-refresh"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Payment History Table Content -->
                <div class="content-area">
                    <!-- Desktop Payment History Table -->
                    <div class="table-container">
                        <table class="data-table payments-table">
                            <thead>
                                <tr>
                                    <th><i class="fas fa-user"></i> Tenant</th>
                                    <th><i class="fas fa-building"></i> Unit</th>
                                    <th><i class="fas fa-calendar"></i> Payment Date</th>
                                    <th><i class="fas fa-file-alt"></i> Description</th>
                                    <th><i class="fas fa-peso-sign"></i> Amount</th>
                                    <th><i class="fas fa-credit-card"></i> Method</th>
                                    <th><i class="fas fa-hashtag"></i> Reference</th>
                                    <th><i class="fas fa-cogs"></i> Actions</th>
                                </tr>
                            </thead>
                            <tbody id="payments-tbody">
                                <!-- Content will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Mobile Payment History Cards -->
                    <div class="mobile-cards" id="payments-mobile">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/javascript/paymentAdmin.js"></script>
        <script>
        var user = null;
        try {
            user = JSON.parse(localStorage.getItem('user'));
        } catch (e) { }

        var userRole = (user && user.role) ? user.role.toUpperCase() : 'TENANT';

        if (userRole === 'ADMIN') {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsAdmin.js';
            document.body.appendChild(script);
        } else {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsTenant.js';
            document.body.appendChild(script);
        }
    </script>
</body>
</html>