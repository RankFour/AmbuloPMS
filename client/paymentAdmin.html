<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/paymentAdmin.css">
    <link rel="stylesheet" href="/css/navigation.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <title>Manage Payment</title>
</head>

<body>
    <div class="overlay" id="overlay"></div>

    <div id="sidebarContainer"></div>
    <div id="navbarContainer"></div>

    <div class="main-content">
        <div class="container">
            <!-- Breadcrumb Navigation -->
            <div class="breadcrumb-container">
                <nav class="breadcrumb-nav">
                    <a href="/adminDashboard.html">
                        <i class="fas fa-home"></i>
                        Dashboard
                    </a>
                    <span class="breadcrumb-separator">></span>
                    <span class="breadcrumb-current">Payment Management</span>
                </nav>
            </div>

            <!-- Enhanced Statistics Grid -->
            <div class="stats-grid fade-in">
                <div class="stat-card outstanding" onclick="filterByStatus('outstanding')">
                    <div class="stat-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="outstanding-charges">0</div>
                        <div class="stat-label">Outstanding Charges</div>
                        <div class="stat-description">Unpaid & overdue</div>
                    </div>
                </div>
                <div class="stat-card collected" onclick="filterByStatus('paid')">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="collected-amount">₱0</div>
                        <div class="stat-label">Collected This Month</div>
                        <div class="stat-description">Successfully received</div>
                    </div>
                </div>
                <div class="stat-card pending" onclick="filterByStatus('pending')">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="pending-charges">0</div>
                        <div class="stat-label">Pending Payments</div>
                        <div class="stat-description">Awaiting payment</div>
                    </div>
                </div>
                <div class="stat-card revenue">
                    <div class="stat-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-revenue">₱0</div>
                        <div class="stat-label">Total Revenue</div>
                        <div class="stat-description">All time collections</div>
                    </div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="charges" onclick="switchTab('charges')">
                        <i class="fas fa-file-invoice"></i>
                        <span>Charges Management</span>
                    </button>
                    <button class="tab-button" data-tab="payments" onclick="switchTab('payments')">
                        <i class="fas fa-history"></i>
                        <span>Payment History</span>
                    </button>
                </div>
            </div>

            <!-- Tab Content Container -->
            <div class="tab-content-container">
                <!-- Charges Tab Content -->
                <div class="tab-content active" id="charges-tab">
                    <div class="table-section fade-in">
                        <div class="section-header charges">
                            <div class="section-title">
                                <i class="fas fa-file-invoice"></i>
                                All Charges
                            </div>
                        </div>

                        <!-- Charges Filter Section -->
                        <div class="filter-section">
                            <div class="filter-grid">
                                <div class="filter-item">
                                    <label>Search Tenant/Unit</label>
                                    <input type="text" id="charges-search" placeholder="Search..."
                                        oninput="filterCharges()">
                                </div>
                                <div class="filter-item">
                                    <label>Charge Type</label>
                                    <select id="charges-type" onchange="filterCharges()">
                                        <option value="">All Types</option>
                                        <option value="rent">Rent</option>
                                        <option value="utility">Utility</option>
                                        <option value="maintenance">Maintenance</option>
                                        <option value="penalty">Penalty</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label>Status</label>
                                    <select id="charges-status" onchange="filterCharges()">
                                        <option value="">All Statuses</option>
                                        <option value="overdue">Overdue</option>
                                        <option value="due-soon">Due Soon</option>
                                        <option value="pending">Pending</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label>Due Date</label>
                                    <input type="month" id="charges-date" onchange="filterCharges()">
                                </div>
                                <div class="filter-item">
                                    <button class="btn btn-secondary" onclick="resetChargesFilters()">
                                        <i class="fas fa-refresh"></i> Reset
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Charges Table Content -->
                        <div class="content-area">
                            <!-- Table Header with Stats and Button -->
                            <div class="table-header-row">
                                <div class="table-stats">
                                    <div class="section-stat" id="charges-total-stat">0 Total</div>
                                    <div class="section-stat" id="charges-overdue-stat">0 Overdue</div>
                                    <div class="section-stat" id="charges-active-stat">0 Active</div>
                                </div>
                                <button class="btn btn-primary table-action-btn"
                                    onclick="addNewCharge()">
                                    <i class="fas fa-plus"></i> Add Charge
                                </button>
                            </div>

                            <!-- Desktop Charges Table -->
                            <div class="table-container">
                                <table class="data-table charges-table">
                                    <thead>
                                        <tr>
                                            <th class="th-number">#</th>
                                            <th class="th-tenant sortable" onclick="sortTable('tenant')">Tenant</th>
                                            <th class="th-unit sortable" onclick="sortTable('unit')">Unit</th>
                                            <th class="th-type sortable" onclick="sortTable('type')">Type</th>
                                            <th class="th-description sortable" onclick="sortTable('description')">
                                                Description</th>
                                            <th class="th-total sortable" onclick="sortTable('amount')">Total Amount
                                            </th>
                                            <th class="th-paid sortable" onclick="sortTable('paid')">Paid Amount</th>
                                            <th class="th-status sortable" onclick="sortTable('status')">Status</th>
                                            <th class="th-due sortable" onclick="sortTable('dueDate')">Due Date</th>
                                            <th class="th-actions">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="charges-tbody">
                                        <!-- Content will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Mobile Charges Cards -->
                            <div class="mobile-cards" id="charges-mobile">
                                <!-- Content will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payments Tab Content -->
                <div class="tab-content" id="payments-tab">
                    <div class="table-section fade-in">
                        <div class="section-header payments">
                            <div class="section-title">
                                <i class="fas fa-history"></i>
                                Payment History
                            </div>
                            <div class="section-stats">
                                <div class="section-stat" id="payments-count-stat">0 Payments</div>
                                <div class="section-stat" id="payments-amount-stat">₱0 Collected</div>
                                <div class="section-stat" id="payments-month-stat">This Month: ₱0</div>
                            </div>
                        </div>

                        <!-- Payment History Filter Section -->
                        <div class="filter-section">
                            <div class="filter-grid">
                                <div class="filter-item">
                                    <label>Search Tenant/Unit</label>
                                    <input type="text" id="payments-search" placeholder="Search..."
                                        oninput="filterPayments()">
                                </div>
                                <div class="filter-item">
                                    <label>Payment Method</label>
                                    <select id="payments-method" onchange="filterPayments()">
                                        <option value="">All Methods</option>
                                        <option value="cash">Cash</option>
                                        <option value="gcash">GCash</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label>Payment Type</label>
                                    <select id="payments-type" onchange="filterPayments()">
                                        <option value="">All Types</option>
                                        <option value="rent">Rent Payment</option>
                                        <option value="utility">Utility Payment</option>
                                        <option value="maintenance">Maintenance Payment</option>
                                        <option value="penalty">Penalty Payment</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label>Payment Date</label>
                                    <input type="month" id="payments-date" onchange="filterPayments()">
                                </div>
                                <div class="filter-item">
                                    <button class="btn btn-secondary" onclick="resetPaymentsFilters()">
                                        <i class="fas fa-refresh"></i> Reset
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Payment History Table Content -->
                        <div class="content-area">
                            <!-- Desktop Payment History Table -->
                            <div class="table-container">
                                <table class="data-table payments-table">
                                    <thead>
                                        <tr>
                                            <th><i class="fas fa-user"></i> Tenant</th>
                                            <th><i class="fas fa-building"></i> Unit</th>
                                            <th><i class="fas fa-calendar"></i> Payment Date</th>
                                            <th><i class="fas fa-file-alt"></i> Description</th>
                                            <th><i class="fas fa-peso-sign"></i> Amount</th>
                                            <th><i class="fas fa-credit-card"></i> Method</th>
                                            <th><i class="fas fa-hashtag"></i> Reference</th>
                                            <th><i class="fas fa-cogs"></i> Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="payments-tbody">
                                        <!-- Content will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- Mobile Payment History Cards -->
                            <div class="mobile-cards" id="payments-mobile">
                                <!-- Content will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div> 
    </div> 
    </div> 

    <script type="module" src="/javascript/paymentAdmin.js"></script>
    <script>
        var user = null;
        try {
            user = JSON.parse(localStorage.getItem('user'));
        } catch (e) { }

        var userRole = (user && user.role) ? user.role.toUpperCase() : 'TENANT';

        if (userRole === 'ADMIN') {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsAdmin.js';
            document.body.appendChild(script);
        } else {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsTenant.js';
            document.body.appendChild(script);
        }
    </script>
</body>

</html>