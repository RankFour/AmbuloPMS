<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/paymentAdmin.css">
    <link rel="stylesheet" href="/css/navigationsAdmin.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <title>Manage Payment</title>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    
    <div id="sidebarContainer"></div>
    <div id="navbarContainer"></div>

    <div class="main-content">
        <div class="container">

            <!-- Statistics Cards -->
            <div class="stats-grid">
                <div class="stat-card total" onclick="filterByType('')">
                    <div class="stat-number" id="total-charges">156</div>
                    <div class="stat-label">Total Charges</div>
                </div>
                <div class="stat-card monthly" onclick="filterByType('rent')">
                    <div class="stat-number" id="monthly-charges">89</div>
                    <div class="stat-label">Monthly Rent</div>
                </div>
                <div class="stat-card utility" onclick="filterByType('utility')">
                    <div class="stat-number" id="utility-charges">42</div>
                    <div class="stat-label">Utility Charges</div>
                </div>
                <div class="stat-card maintenance" onclick="filterByType('maintenance')">
                    <div class="stat-number" id="maintenance-charges">25</div>
                    <div class="stat-label">Maintenance</div>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="filter-section">
                <button class="filter-toggle" onclick="toggleFilters()">
                    <i class="fas fa-filter"></i> Filters & Search
                </button>
                <div class="filter-grid" id="filter-grid">
                    <div class="filter-item">
                        <label>Search Tenant/Unit</label>
                        <input type="text" id="search-filter" placeholder="Search by tenant name or unit..." oninput="filterLeases()">
                    </div>
                    <div class="filter-item">
                        <label>Charge Type</label>
                        <select id="type-filter" onchange="filterLeases()">
                            <option value="">All Types</option>
                            <option value="rent">Rent</option>
                            <option value="utility">Utility</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="penalty">Penalty</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>Status</label>
                        <select id="status-filter" onchange="filterLeases()">
                            <option value="">All Statuses</option>
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="paid">Paid</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>Date Range</label>
                        <input type="month" id="month-filter" onchange="filterLeases()">
                    </div>
                    <div class="filter-item">
                        <label>Actions</label>
                        <button class="btn btn-primary" onclick="resetFilters()">
                            <i class="fas fa-refresh"></i> Reset
                        </button>
                    </div>
                </div>
            </div>

            <div class="header-actions">
                <button class="btn btn-primary" onclick="window.location.href='/add-charges.html'">
                    <i class="fas fa-plus"></i> Add Charges
                </button>
            </div>

            <!-- Lease Cards Container -->
            <div class="lease-cards-container" id="lease-cards">
                <!-- Dynamic content will be loaded here -->
            </div>

            <div class="general-payment-history" id="general-payment-history">
            <div class="section-header">
                <div class="section-title">
                    <i class="fas fa-history"></i>
                    Payment Overview
                </div>
                <div class="payment-stats">
                    <span class="payment-stat paid">
                        <i class="fas fa-check-circle"></i>
                        <span id="paid-count">0</span> Paid
                    </span>
                    <span class="payment-stat overdue">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span id="overdue-count">0</span> Overdue
                    </span>
                    <span class="payment-stat pending">
                        <i class="fas fa-clock"></i>
                        <span id="pending-count">0</span> Pending
                    </span>
                </div>
            </div>

            <div class="payment-filter-tabs">
                <button class="payment-tab active" data-status="all" onclick="filterPaymentHistory('all')">
                    All Charges
                </button>
                <button class="payment-tab" data-status="overdue" onclick="filterPaymentHistory('overdue')">
                    Overdue
                </button>
                <button class="payment-tab" data-status="due-soon" onclick="filterPaymentHistory('due-soon')">
                    Due Soon
                </button>
                <button class="payment-tab" data-status="paid" onclick="filterPaymentHistory('paid')">
                    Paid
                </button>
            </div>

            <!-- Desktop Table View -->
            <div class="payment-overview-table-container">
                <div class="charges-table-wrapper">
                    <table class="charges-table payment-overview-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-user"></i> Tenant</th>
                                <th><i class="fas fa-building"></i> Unit</th>
                                <th><i class="fas fa-tag"></i> Type</th>
                                <th><i class="fas fa-file-alt"></i> Description</th>
                                <th><i class="fas fa-peso-sign"></i> Amount</th>
                                <th><i class="fas fa-calendar"></i> Due Date</th>
                                <th><i class="fas fa-clock"></i> Days</th>
                                <th><i class="fas fa-check-circle"></i> Status</th>
                                <th><i class="fas fa-cogs"></i> Actions</th>
                            </tr>
                        </thead>
                        <tbody id="payment-overview-tbody">
                            <!-- Dynamic content will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Mobile Card View -->
            <div class="payment-overview-mobile">
                <div id="payment-overview-cards">
                    <!-- Dynamic mobile cards will be loaded here -->
                </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Charge Details Modal -->
    <div class="modal" id="charge-details-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-file-invoice"></i>
                    Charge Details
                </h2>
                <button class="close-btn" onclick="closeModal('charge-details-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body" id="modal-charge-details">
                <!-- Dynamic charge details will be loaded here -->
            </div>
        </div>
    </div>

    <script type="module" src="/javascript/paymentAdmin.js"></script>
        <script>
        var user = null;
        try {
            user = JSON.parse(localStorage.getItem('user'));
        } catch (e) { }

        var userRole = (user && user.role) ? user.role.toUpperCase() : 'TENANT';

        if (userRole === 'ADMIN') {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsAdmin.js';
            document.body.appendChild(script);
        } else {
            var script = document.createElement('script');
            script.src = '/javascript/navigationsTenant.js';
            document.body.appendChild(script);
        }
    </script>
</body>
</html>